
{% extends "base.html" %} {% block title %}{{ hotel.hotel_name }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/hotel_detail.css') }}">
{% endblock %}

{% block content %}

<!-- Hotel Image and Description Section -->
<div class="hotel-detail-container">
    <div class="hotel-image-section">
        {% if hotel.main_image %}
        <img src="{{ url_for('static', filename=hotel.main_image) }}" 
             alt="{{ hotel.hotel_name }}"
             onerror="this.onerror=null; this.src='{{ url_for('static', filename='images/placeholder.jpg') }}'" />
        {% else %}
        <img src="{{ url_for('static', filename='images/placeholder.jpg') }}" 
             alt="Hotel placeholder" />
        {% endif %}
    </div>
    
    <div class="hotel-info-section ">
        <h1>{{ hotel.hotel_name }}</h1>
        <div class="hotel-location">
            <i class="fas fa-map-marker-alt"></i> {{ hotel.city_name }}
        </div>
        <div class="hotel-stars">
            {% for _ in range(hotel.star_rating) %}
            <i class="fas fa-star"></i>
            {% endfor %}
        </div>
        <p class="hotel-description">{{ hotel.description }}</p>
        <div class="hotel-features">
            <h5>Hotel Features:</h5>
            <div class="features-grid">
                {% for feature in hotel.hotel_features.split(',') %}
                <span class="feature-badge">{{ feature.strip() }}</span>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<!-- Check Availability Section -->
<div class="availability-section">
    <form method="GET" action="{{ url_for('hotel_detail', hotel_id=hotel.hotel_id) }}" class="search-form">
        <div class="search-group">
            <label>CHECK IN</label>
            <input type="date" name="check_in" class="search-input" value="{{ check_in }}" required min="{{ today }}">
            <small>Book up to 3 months in advance</small>
        </div>

        <div class="search-group">
            <label>CHECK OUT</label>
            <input type="date" name="check_out" class="search-input" value="{{ check_out }}" required>
            <small>Maximum stay: 30 days</small>
        </div>

        <div class="search-group">
            <label>GUESTS</label>
            <select name="guests" class="search-input">
                {% for i in range(1, 6) %}
                <option value="{{ i }}" {% if guests|string==i|string %}selected{% endif %}>
                    {{ i }} Guest{{ 's' if i > 1 }}
                </option>
                {% endfor %}
            </select>
        </div>
        <!-- Currency Section -->
        <div class="search-group">
            <label>CURRENCY</label>
            <div class="dropdown">
                <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="currencyDropdown"
                    data-bs-toggle="dropdown" aria-expanded="false">
                    {{ currency_symbol }} {{ currency }}
                </button>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="currencyDropdown">
                    {% for code, symbol in currencies.items() %}
                    <li>
                        <a class="dropdown-item {% if currency == code %}active{% endif %}"
                            href="{{ url_for('set_currency', currency=code) }}">
                            {{ symbol }} {{ code }}
                        </a>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        <!-- Check Availability Button -->
        <div class="button-group">
            <button type="submit" class="search-button">CHECK AVAILABILITY</button>
        </div>
    </form>
</div>

<!-- Available Rooms Section -->
{% if rooms %}
<div class="room-details py-5">
    <div class="container">
        <div class="row gy-4">
            {% for room in rooms %}
            <div class="col-md-4">
                <div class="card-rooms-card fade-target">
                    {% if room.main_image %}
                        <img src="{{ url_for('static', filename=room.main_image) }}" 
                             class="card-img-top" 
                             alt="{{ room.type_name }}"
                             onerror="this.onerror=null; this.src='{{ url_for('static', filename='images/placeholder.jpg') }}">
                    {% else %}
                        <img src="{{ url_for('static', filename='images/placeholder.jpg') }}" 
                             class="card-img-top" 
                             alt="Room placeholder">
                    {% endif %}
                    
                    <div class="card-body">
                        <h5 class="card-title fade-target">{{ room.type_name }} Room</h5>
                        
                        <!-- Room Features -->
                        <div class="features mb-3">
                            {% for feature in room.features.split(',') %}
                            <span class="badge bg-secondary me-1 fade-target">
                                <i class="fas fa-{{ feature_icons.get(feature.strip(), 'check') }}"></i>
                                {{ feature.strip() }}
                            </span>
                            {% endfor %}
                        </div>
                        
                        <!-- Price Breakdown -->
                        <div class="price-breakdown">
                            {% if room.discount_amount > 0 %}
                            <p class="mb-1">
                                <span class="text-muted text-decoration-line-through fade-target">
                                    {{ currency_symbol }}{{ "%.2f"|format(room.original_price) }}
                                </span>
                                <span class="badge bg-success ms-2 fade-target">
                                    Save {{ currency_symbol }}{{ "%.2f"|format(room.discount_amount) }}
                                </span>
                            </p>
                            {% endif %}
                            <h4 class="text-primary">
                                {{ currency_symbol }}{{ "%.2f"|format(room.final_price) }}
                                <small class="text-muted">per night</small>
                            </h4>
                        </div>
                        
                        <!-- Book Now Button -->
                        <a href="{{ url_for('book_room', room_id=room.room_id, 
                                    check_in=check_in, 
                                    check_out=check_out, 
                                    guests=guests) }}" 
                        class="btn btn-primary mt-3">Book Now</a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% elif check_in and check_out %}
<div class="alert alert-info fade-target">
    No rooms available for the selected dates. Please try different dates.
</div>
{% endif %}

<!-- Hotel Offers -->
<div class="hotel-offers fade-target">
  <h2 class="offers-title fade-target">HOTEL SPECIAL OFFERS</h2>
  <p class="offers-description fade-target">
    World Hotels offers luxury hotel packages, special promotions and
    attractive offers for business travellers looking for convenience,
    efficiency and an energetic vibe that helps them get things done, and
    leisure travellers wanting a friendly social atmosphere where people
    gather to enjoy themselves and have fun.
  </p>

  <div class="offers-grid">
    <div class="offer-card fade-target">
      <div class="offer-image-container">
        <img
          src="{{ url_for('static', filename='images/online.jpg') }}"
          alt="Aerial view of luxury resort"
        />
        <div class="offer-banner">ONLINE EXCLUSIVE</div>
      </div>
      <div class="offer-content">
        <h3 class="fade-target">ONLINE EXCLUSIVE</h3>
        <p class="fade-target">Enjoy your stay. Book now on one click and enjoy your stay at the best price at World Hotels.</p>
        <div class="offer-buttons">
          <a href="{{ url_for('hotels') }}" class="btn-learn fade-target">LEARN MORE</a>
          <a href="{{ url_for('search') }}" class="btn-book fade-target">EXPLORE</a>
        </div>
      </div>
    </div>

    <div class="offer-card fade-target">
      <div class="offer-image-container">
        <img
          src="{{ url_for('static', filename='images/holiday.jpg') }}"
          alt="Villa with private pool"
        />
      </div>
      <div class="offer-content">
        <h3 class="fade-target">HOLIDAY TOGETHER</h3>
        <p class="fade-target">
          Book a two-night family stay and enjoy breakfast included for 2
          adults and 2 children.
        </p>
        <div class="offer-buttons">
          <a href="{{ url_for('hotels') }}" class="btn-learn fade-target">LEARN MORE</a>
          <a href="{{ url_for('search') }}" class="btn-book fade-target">EXPLORE</a>
        </div>
      </div>
    </div>

    <div class="offer-card fade-target">
      <div class="offer-image-container">
        <img
          src="{{ url_for('static', filename='images/summeredition.jpg') }}"
          alt="Luxury lounge interior"
        />
      </div>
      <div class="offer-content">
        <h3 class="fade-target">ELEVATE IN STYLE – SUMMER EDITION</h3>
        <p class="fade-target">
          Book your summer stays with spacious accommodation and exclusive
          lounge access.
        </p>
        <div class="offer-buttons">
          <a href="{{ url_for('hotels') }}" class="btn-learn fade-target">LEARN MORE</a>
          <a href="{{ url_for('search') }}" class="btn-book fade-target">EXPLORE</a>
        </div>
      </div>
    </div>

    <div class="offer-card fade-target">
      <div class="offer-image-container">
        <img
          src="{{ url_for('static', filename='images/bookinadvance.jpg') }}"
          alt="Indoor swimming pool"
        />
      </div>
      <div class="offer-content">
        <h3 class="fade-target">BOOK IN ADVANCE</h3>
        <p class="fade-target">15% off for bookings made 60+ days in advance</p>
        <div class="offer-buttons">
          <a href="{{ url_for('hotels') }}" class="btn-learn fade-target">LEARN MORE</a>
          <a href="{{ url_for('search') }}" class="btn-book fade-target">EXPLORE</a>
        </div>
      </div>
    </div>

    <div class="offer-card fade-target">
      <div class="offer-image-container">
        <img
          src="{{ url_for('static', filename='images/extendstay.jpg') }}"
          alt="Rooftop bar"
        />
      </div>
      <div class="offer-content">
        <h3 class="fade-target">EXTEND YOUR STAY</h3>
        <h7 class="fade-target">In 30 days</h7>
        <p class="fade-target">
          Stay longer and enjoy better rates with daily breakfast included.
        </p>
        <div class="offer-buttons">
          <a href="{{ url_for('hotels') }}" class="btn-learn fade-target">LEARN MORE</a>
          <a href="{{ url_for('search') }}" class="btn-book fade-target">EXPLORE</a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Hotel Amenities -->
<div class="card mb-4 amenities-card fade-target">
    <div class="card-body">
        <h2 class="amenities-title">Hotel Amenities</h2>
        <div class="amenities-container">
            <div class="amenity-item">
                <i class="fas fa-map-marker-alt"></i>
                <span>Around 2 iconic landmarks like Buckingham Palace </span>
            </div>
            <div class="amenity-item">
                <i class="fas fa-place-of-worship"></i>
                <span>Around 3 Mins away from Tyne Bridge</span>
            </div>
            <div class="amenity-item">
                <i class="fas fa-paw "></i>
                <span>Around 8 Mins away from Titanic Belfast</span>
            </div>
            <div class="amenity-item">
                <i class="fas fa-plane"></i>
                <span>Around 33 Mins away from Birmingham Museum</span>
            </div>
            <div class="amenity-item ">
                <i class="fas fa-map-marker-alt"></i>
                <span>Around 38 Mins away from River Tyne</span>
            </div>
            <div class="amenity-item ">
                <i class="fas fa-concierge-bell"></i>
                <span>24-hours Travel Desk</span>
            </div>
            <div class="amenity-item ">
                <i class="fas fa-dumbbell"></i>
                <span>Playfit Fitness Centre with Steam & Sauna</span>
            </div>
            <div class="amenity-item">
                <i class="fas fa-swimming-pool"></i>
                <span>Adult & Kids Pool</span>
            </div>
            <div class="amenity-item">
                <i class="fas fa-gamepad"></i>
                <span>Games Room & Kids Play Area</span>
            </div>
            <div class="amenity-item">
                <i class="fas fa-hotel"></i>
                <span>Seven Banquet Halls</span>
            </div>
            <div class="amenity-item">
                <i class="fas fa-wifi"></i>
                <span>Complimentary Wi-Fi</span>
            </div>
            <div class="amenity-item">
                <i class="fas fa-charging-station"></i>
                <span>EV Charging Point</span>
            </div>
            <div class="amenity-item">
                <i class="fas fa-utensils"></i>
                <span>Pure-veg Restaurant & Bar</span>
            </div>
        </div>
    </div>
</div>

<!-- Reviews Section -->
<div class="reviews-section">
  <h4>Guest Reviews</h4>

  <!-- Write Review Button -->
  {% if session.get('user_id') %}
  <div class="mb-4">
      <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#reviewModal">
          Write a Review
      </button>
  </div>
  {% else %}
  <div class="alert alert-info mb-4">
      <p>Please <a href="{{ url_for('login') }}">login</a> to submit a review.</p>
  </div>
  {% endif %}

  <!-- Display Reviews -->
  {% if reviews %}
      {% for review in reviews %}
      <div class="review border-bottom py-3">
          <div class="d-flex justify-content-between">
              <div>
                  <h6>{{ review.first_name }} {{ review.last_name[0] }}.</h6>
                  <div class="rating">
                      {% for _ in range(review.rating) %}
                      <i class="fas fa-star text-warning"></i>
                      {% endfor %}
                  </div>
              </div>
              <small class="text-muted"
                  >{{ review.review_date.strftime('%B %d, %Y') }}</small
              >
          </div>
          <p class="mt-2">{{ review.comment }}</p>
      </div>
      {% endfor %}
  {% else %}
      <p class="text-muted">No reviews yet.</p>
  {% endif %}
</div>

<!-- Review Modal -->
{% if session.get('user_id') %}
<div class="modal fade" id="reviewModal" tabindex="-1">
<div class="modal-dialog">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title">Write a Review</h5>
      <button
        type="button"
        class="btn-close"
        data-bs-dismiss="modal"
      ></button>
    </div>
    <form
      action="{{ url_for('submit_review', hotel_id=hotel.hotel_id) }}"
      method="POST"
    >
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
      <div class="modal-body">
        <div class="mb-3">
          <label class="form-label">Rating</label>
          <select name="rating" class="form-select" required>
            {% for i in range(1, 6) %}
            <option value="{{ i }}">{{ i }} Star{{ 's' if i > 1 }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="mb-3">
          <label class="form-label">Comment</label>
          <textarea
            name="comment"
            class="form-control"
            rows="4"
            required
          ></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary"
          data-bs-dismiss="modal"
        >
          Cancel
        </button>
        <button type="submit" class="btn btn-primary">Submit Review</button>
      </div>
    </form>
    <a href="{{ url_for('reviews') }}" class="btn btn-secondary fade-target"
      >Read More Reviews</a
    >
  </div>
</div>
</div>

{% endif %}

<!-- Back to Top Button -->
<button id="back-to-top" title="Go to top">↑</button>

{% endblock %} {% block extra_js %}

<script src="{{ url_for('static', filename='js/hotel_detail.js') }}"></script>
<script src="{{ url_for('static', filename='js/main.js') }}"></script>

{% endblock %}
