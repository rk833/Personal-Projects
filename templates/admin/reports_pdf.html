<!DOCTYPE html>
<html>
  <head>
    <style>
      body {
        font-family: Arial, sans-serif;
      }
      .header {
        text-align: center;
        margin-bottom: 30px;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 30px;
      }
      th,
      td {
        padding: 8px;
        text-align: left;
        border-bottom: 1px solid #ddd;
      }
      th {
        background-color: #4e73df;
        color: white;
      }
      .section {
        margin-bottom: 30px;
      }
      .date-range {
        text-align: center;
        color: #666;
        margin-bottom: 20px;
      }
      .summary-card {
        background: #f8f9fc;
        padding: 15px;
        margin-bottom: 20px;
        border: 1px solid #ddd;
      }
    </style>
  </head>
  <body>
    <!-- Report Container -->
    <div class="header">
      <h1>Hotel Management Report</h1>
      <div class="date-range">
        {{ start_date.strftime('%Y-%m-%d') }} to {{
        end_date.strftime('%Y-%m-%d') }}
      </div>
    </div>

    <!-- Summary Cards -->
    <div class="section">
      <h2>Summary</h2>
      <div class="summary-card">
        <p>
          <strong>Total Revenue:</strong> £{{ "%.2f"|format(total_revenue|float)
          }}
        </p>
        <p><strong>Total Bookings:</strong> {{ total_bookings }}</p>
        <p>
          <strong>Average Booking Value:</strong> £{{
          "%.2f"|format(avg_booking_value|float) }}
        </p>
        <p><strong>Total Customers:</strong> {{ total_customers }}</p>
      </div>
    </div>

    <!-- Monthly Sales Analysis -->
    <div class="section">
      <h2>Monthly Sales Analysis</h2>
      <table>
        <thead>
          <tr>
            <th>Month</th>
            <th>Bookings</th>
            <th>Revenue</th>
            <th>Unique Customers</th>
            <th>Total Discounts</th>
          </tr>
        </thead>
        <tbody>
          {% for sale in monthly_sales %}
          <tr>
            <td>{{ sale.month }}</td>
            <td>{{ sale.booking_count }}</td>
            <td>£{{ "%.2f"|format(sale.revenue|float) }}</td>
            <td>{{ sale.unique_customers }}</td>
            <td>£{{ "%.2f"|format(sale.total_discounts|float) }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Top Performing Hotels -->
    <div class="section">
      <h2>Top Performing Hotels</h2>
      <table>
        <thead>
          <tr>
            <th>Hotel Name</th>
            <th>Bookings</th>
            <th>Revenue</th>
            <th>Avg Rating</th>
            <th>Occupancy Rate</th>
          </tr>
        </thead>
        <tbody>
          {% for hotel in hotel_performance[:5] %}
          <tr>
            <td>{{ hotel.hotel_name }}</td>
            <td>{{ hotel.booking_count }}</td>
            <td>£{{ "%.2f"|format(hotel.revenue|float) }}</td>
            <td>{{ "%.1f"|format(hotel.avg_rating|float) }}</td>
            <td>
              {{ "%.1f"|format((hotel.occupied_days / 30 * 100)|float) }}%
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Hotel Performance Analysis -->
    <div class="section">
      <h2>Hotel Performance Analysis</h2>
      <table>
        <thead>
          <tr>
            <th>Hotel Name</th>
            <th>Bookings</th>
            <th>Revenue</th>
            <th>Unique Customers</th>
            <th>Avg Booking Value</th>
            <th>Total Rooms</th>
            <th>Avg Rating</th>
            <th>Review Count</th>
            <th>Occupied Days</th>
            <th>Estimated Profit</th>
          </tr>
        </thead>
        <tbody>
          {% for hotel in hotel_performance %}
          <tr>
            <td>{{ hotel.hotel_name }}</td>
            <td>{{ hotel.booking_count }}</td>
            <td>£{{ "%.2f"|format(hotel.revenue|float) }}</td>
            <td>{{ hotel.unique_customers }}</td>
            <td>£{{ "%.2f"|format(hotel.avg_booking_value|float) }}</td>
            <td>{{ hotel.total_rooms }}</td>
            <td>{{ "%.1f"|format(hotel.avg_rating|float) }}</td>
            <td>{{ hotel.review_count }}</td>
            <td>{{ hotel.occupied_days }}</td>
            <td>£{{ "%.2f"|format(hotel.estimated_profit|float) }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Recent Bookings -->
    <div class="section">
      <h2>Recent Bookings</h2>
      <table>
        <thead>
          <tr>
            <th>Booking ID</th>
            <th>Hotel</th>
            <th>Guest</th>
            <th>Check In</th>
            <th>Check Out</th>
            <th>Status</th>
            <th>Amount</th>
          </tr>
        </thead>
        <tbody>
          {% for booking in recent_bookings %}
          <tr>
            <td>{{ booking.booking_id }}</td>
            <td>{{ booking.hotel_name }}</td>
            <td>{{ booking.guest_name or booking.user_name }}</td>
            <td>{{ booking.check_in_date.strftime('%Y-%m-%d') }}</td>
            <td>{{ booking.check_out_date.strftime('%Y-%m-%d') }}</td>
            <td>{{ booking.status }}</td>
            <td>£{{ "%.2f"|format(booking.total_price|float) }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </body>
</html>
